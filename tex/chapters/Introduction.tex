\chapter{Introduction}

Remote sensing aims to measure target variables efficiently from a distance. In this context, satellite imagery Time Series ({TS}) such as the imagery {TS} of the multi-spectral Sentinel 2 satellites freely distributed by the European Space Agency are used \citep{esaSentinel22022}.
% stakeholders + applications  
Large scale monitoring of forest and agricultural vegetation dynamics is of great interest to authorities, insurance companies and environmental and climate researchers. Examples include crop classification for subsidizing farmers \citep{henitsSentinel2EnablesNationwide2022} and the creation of crop models for estimating crop yields or nitrogen concentrations \citep{couraultSTICSCropModel2021,perichCropNitrogenRetrieval2021}. 
% Season Start (start of spring) (community name: land surface plant phenology)
% NDVI
In order to transform the high dimensional satellite images into easily interpretable metrics, spectral indices such as the Normalized Difference Vegetation Index (NDVI) are used \citep{rouseMonitoringVernalAdvancement1974}. The NDVI serves as a proxy for vegetation density (or chlorophyll content to be more resize), and thus the corresponding {TS} reflects the vegetation development. 
% S2 issues (clouds ...)
The quality of a satellite image, however, depends on atmospheric conditions and thus in case of a dense cloud cover, the information content derived from the NDVI is impaired. Therefore, the European Space Agency also provides a Scene Classification Layer (SCL), which provides additional metadata about what is observed (e.g., shadows, clouds, vegetation, etc.) \citep{esaLevel2AAlgorithmOverview2022}. So when extracting the NDVI {TS} from the Sentinel 2 satellite imagery {TS}, we can filter out the corrupted observations using the SCL classification. However, due to this filtration it may occur that we have no observations for several weeks, especially in winter, or that some observations are wrongly classified by the SCL (e.g., as vegetation) and thus result in an erroneous NDVI. Consequently, the main challenge is to interpolate an NDVI {TS}, which can contain both large data gaps and outliers. 

% state-of-the-art
There are several approaches to adequately address this issue. One is to look at the observed evolution of vegetation density and assume its bell shape for the NDVI {TS} given the strong correlation between NDVI and vegetation density. Approaches to model this include a 2nd order Fourier approximation \citep{stockliEuropeanPlantPhenology2004} or a Double Logistic function \citep{beckImprovedMonitoringVegetation2006}.
On the other hand, assumptions are made about more abstract properties of the curve, such as smoothness or the like. We divide these into local and global approaches. Nadaraya-Watson \citep{strbacEstimationEvapotrasnpirationUrban2017}, Savitzky-Golay Filter \citep{chenSimpleMethodReconstructing2004a} and Locally Reweighted Regression \citep{omoriAssessmentPaddyFields2021} use a sliding window to interpolate the {TS} stepwise. Global methods like B-Splines \citep{gurungPredictingEnhancedVegetation2009} and Smoothing Splines \citep{caiPerformanceSmoothingMethods2017} reduce the squares of all residuals simultaneously, and Universal Kriging fits a Gaussian process to the data \citep{chandolaScalableTimeSeries2010}.
% SS defined in \cite{cravenSmoothingNoisyData1978}

% my contribuition:
In this thesis, we will discuss the strengths and weaknesses of these Interpolation Methods ({{IM}}s) and evaluate them with respect to NDVI interpolation. For this purpose, we use the Sentinel 2 satellite image {TS} and crop yield maps of different fields of different wheat species on a farm in Witzwil, Switzerland over the years 2017-2021.
To improve {{IM}}s, we generalize and test an iterative technique that makes interpolations more robust to outliers by weighting them less. Additionally, we determine how data gaps affect the different {{IM}}s. Furthermore, using NDVI as an example, we present a general interpolation procedure that utilizes additional information to correct the target variable with an uncertainty estimate and then interpolates. Thus, we no longer have to filter the observations a priori via the SCL, but instead correct the observed NDVI and weight the observations via the estimated uncertainties. Combining {{IM}}s with the NDVI correcting models produces 28 Interpolation Strategies ({{ISs}}). We benchmark these against an objective quality measure, which assumes that the better an NDVI TS models crop growth, the more appropriate it is for estimating crop yield.

\bigskip
The research questions, which are pursued in this thesis, are:
\begin{Nenumerate}
    \item Which {{IM}}s are used in the context of NDVI, and what are their advantages and disadvantages?
\item How may contaminated data be dealt with?
    \item How do data gaps affect interpolation?
\item How to deal with data gaps?
    \item How can we recognize a good interpolation of the NDVI?
\end{Nenumerate}
\bigskip

% Roadmap:
The thesis is structured as follows: After presenting the available data, illustrating challenges and defining different concepts in chapter~\ref{sec:data_methods}, we turn to the two main blocks of this thesis. 
On the first, in section~\ref{sec:itpl} we study parametric and non-parametric {{IM}}s (question i.), generalize an iterative robustification technique (question ii.), and show a way to evaluate interpolations with out-of-bag residuals (question v.). In section~\ref{sec:discussion_itpl_data_gaps} we discuss how different {{IM}}s respond to data gaps (question iii.), and in section~\ref{sec:itpl_preselection} we preselect {{IM}}s. We evaluate this preselection in~\ref{sec:results_itpl} and select two candidates from different {{IM}}s in section~\ref{sec:itpl_candiate_selection}.
For the second, we attempt to correct contaminated data with statistical models in section~\ref{sec:corr} (question ii.) and utilize previously ignored observations, which we hope will further reduce data gaps (question iv.). In addition, we compare different {{ISs}} using a vegetation-oriented quality measure (question v.) and describe the results in section~\ref{sec:results_ndvi_corr}. Based on these results, in section~\ref{sec:discussion_corr} we argue what the best {{IS}} is. In addition, we justify why our NDVI correction can be understood as unsupervised learning and why we relied only on satellite imagery and not on meteorological data for the NDVI correction.
Our conclusions of this thesis, recommendations, as well as an outlook on future work is given in chapter~\ref{sec:Conclusion}. 


% und Definieren verschiedene Konzepte. Darunter eine transformation der Zeitachse, welche datenlücken im Winter zusammenschrumpfen lässt (Frage iv.). 




%smoothing:   ``Similarly, smoothing the {TS} of satellite data is helpful to address inconsistency in observation frequency and timing due to clouds and other sensor artefacts \cite{skakunWinterWheatYield2019}''


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "MasterThesisSfS"
%%% End: 
